# Diffusion Stash

## Overview
Diffusion Stash can upload or download Image generative AI models and images generated with them.

## Features
- **Upload/Download Models**: Share your Stable Diffusion checkpoints, LoRAs, VAEs, and more.
- **Upload/Download Images**: Store and share your generated images.
- **Automatic Metadata Extraction**: Automatically decodes and displays workflow information (like prompts, seed, CFG scale) from images generated by ComfyUI and Stable Diffusion Web UI.

## Getting started
For detail examples, please see `./example`.

example `docker-compose.yml` is below.
```yaml
services:
  backend:
    image: ghcr.io/sileader/diffusion-stash/backend
    container_name: diffusion-stash-backend
    command: ["/bin/diffusionstash-backend", "/etc/diffusion-stash/config.yaml"]
    restart: unless-stopped
    volumes:
      - ./data:/data # Persists models and images
      - ./config.yaml:/etc/diffusion-stash/config.yaml
    tmpfs: /tmp # Uploaded files location
  frontend:
    image: ghcr.io/sileader/diffusion-stash/frontend
    container_name: diffusion-stash-frontend
    restart: unless-stopped

  reverse-proxy:
    image: nginx
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
      - 8080:80
    depends_on:
      - backend
      - frontend
```

`nginx.conf`
```
events {
    worker_connections  16;
}
http {
    server {
        listen 80 default;
        location /v1 {
            proxy_pass http://backend:8080;
            proxy_redirect off;
        }
        location / {
            proxy_pass http://frontend:80;
            proxy_redirect off;
        }
    }
}
```

`config.yaml`
```yaml
server:
  listen: 0.0.0.0:8080
storage:
  backend:
    provider: Local
  modelPath:
    provider: ComfyUI
    root: /data/models
    modelTypeDirectory:
      StableDiffusion15: sd1.5
      StableDiffusionXl: sdxl
      PonyDiffusion: pony
      Illustrious: illustrious
      StableDiffusion30: sd3
      StableDiffusion35: sd3.5
      Flux1D: flux.1
      Flux1S: flux.1
  productPath:
    provider: Id
    base: /data/products
database:
  url: "sqlite:///data/database.db"
```

Built frontend container requires same origin backend server.
So the example `docker-compose.yml` starts reverse proxy server.

If you want to change its behavior, please rebuilt frontend container with new environment files.

## License
This project is licensed under the **GNU General Public License v3.0**.
See the [LICENSE](./LICENSE) file for details.

&copy; 2025 SiLeader.
